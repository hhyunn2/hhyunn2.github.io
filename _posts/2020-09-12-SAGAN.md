$f(x)=W_fx$ 

$g(x)=W_gx$ 

$\beta_{j,i}=\frac{exp(s_{ij})}{\sum^N_{i=1}exp(s_{ij})}$

$s_{ij}=f(x_i)^Tg(x_j)$

$o_j =v\left(\sum^N_{i=1}\beta_{j,i}h(x_i)\right)$

$h(x_i)=W_hx_i$ 

$v(x_i)=W_vx_i$

$L_D=-\mathbb{E}_{(x,y)\sim p_{data}}$

